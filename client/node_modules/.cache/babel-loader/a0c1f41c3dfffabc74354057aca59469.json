{"ast":null,"code":"// import config from \"config\";\nimport axios from \"axios\";\nexport function authHeader() {\n  // return authorization header with jwt token\n  let user = JSON.parse(localStorage.getItem(\"user\"));\n\n  if (user && user.token) {\n    return {\n      Authorization: \"Bearer \" + user.token\n    };\n  } else {\n    return {};\n  }\n}\nexport const userService = {\n  login,\n  logout,\n  register,\n  getAll,\n  getById,\n  update,\n  delete: _delete\n};\n\nasync function login(username, password) {\n  let config = {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  };\n  await axios.post(\"/users/authenticate\", {\n    username,\n    password\n  }, config) // .then(handleResponse)\n  .then(response => {\n    // console.log(response);\n    if (response.status !== 200) {\n      console.log(\"Error\");\n    } else {\n      const user = response.data.username; // store user details and jwt token in local storage to keep user logged in between page refreshes\n\n      localStorage.setItem(\"user\", user);\n      localStorage.setItem(\"hash\", response.data.passwordHash);\n      console.log(user);\n      return user;\n    }\n  });\n} // .then((user) => {\n//   console.log(user);\n//   // store user details and jwt token in local storage to keep user logged in between page refreshes\n//   localStorage.setItem(\"user\", user);\n//   return user;\n// });\n\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem(\"user\");\n}\n\nfunction getAll() {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader()\n  };\n  return fetch(`/users/`, requestOptions).then(handleResponse);\n}\n\nfunction getById(id) {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader()\n  };\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction register(user) {\n  axios.post(`/users/register`, user).then(handleResponse);\n}\n\nfunction update(user) {\n  const requestOptions = {\n    method: \"PUT\",\n    headers: { ...authHeader(),\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(user)\n  };\n  return fetch(`/users/${user.id}`, requestOptions).then(handleResponse);\n} // prefixed function name with underscore because delete is a reserved word in javascript\n\n\nfunction _delete(id) {\n  const requestOptions = {\n    method: \"DELETE\",\n    headers: authHeader()\n  };\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n  return response.then(data => {\n    if (response.status !== 200) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        // logout();\n        console.log(\"BAD\"); // location.reload(true);\n      }\n\n      const error = data && data.message || response.statusText;\n      console.log(error);\n      return Promise.reject(error);\n    }\n\n    return data;\n  });\n}","map":{"version":3,"sources":["/Users/Eunice/Documents/my-app/client/src/services/UserService.js"],"names":["axios","authHeader","user","JSON","parse","localStorage","getItem","token","Authorization","userService","login","logout","register","getAll","getById","update","delete","_delete","username","password","config","headers","post","then","response","status","console","log","data","setItem","passwordHash","removeItem","requestOptions","method","fetch","handleResponse","id","body","stringify","error","message","statusText","Promise","reject"],"mappings":"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","sourcesContent":["// import config from \"config\";\nimport axios from \"axios\";\n\nexport function authHeader() {\n  // return authorization header with jwt token\n  let user = JSON.parse(localStorage.getItem(\"user\"));\n\n  if (user && user.token) {\n    return { Authorization: \"Bearer \" + user.token };\n  } else {\n    return {};\n  }\n}\n\nexport const userService = {\n  login,\n  logout,\n  register,\n  getAll,\n  getById,\n  update,\n  delete: _delete,\n};\n\nasync function login(username, password) {\n  let config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  };\n  await axios\n    .post(\"/users/authenticate\", { username, password }, config)\n    // .then(handleResponse)\n\n    .then((response) => {\n      // console.log(response);\n      if (response.status !== 200) {\n        console.log(\"Error\");\n      } else {\n        const user = response.data.username;\n        // store user details and jwt token in local storage to keep user logged in between page refreshes\n        localStorage.setItem(\"user\", user);\n        localStorage.setItem(\"hash\", response.data.passwordHash);\n        console.log(user);\n        return user;\n      }\n    });\n}\n// .then((user) => {\n//   console.log(user);\n//   // store user details and jwt token in local storage to keep user logged in between page refreshes\n//   localStorage.setItem(\"user\", user);\n//   return user;\n// });\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem(\"user\");\n}\n\nfunction getAll() {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/`, requestOptions).then(handleResponse);\n}\n\nfunction getById(id) {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction register(user) {\n  axios.post(`/users/register`, user).then(handleResponse);\n}\n\nfunction update(user) {\n  const requestOptions = {\n    method: \"PUT\",\n    headers: { ...authHeader(), \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(user),\n  };\n\n  return fetch(`/users/${user.id}`, requestOptions).then(handleResponse);\n}\n\n// prefixed function name with underscore because delete is a reserved word in javascript\nfunction _delete(id) {\n  const requestOptions = {\n    method: \"DELETE\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n  return response.then((data) => {\n    if (response.status !== 200) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        // logout();\n        console.log(\"BAD\");\n        // location.reload(true);\n      }\n\n      const error = (data && data.message) || response.statusText;\n      console.log(error);\n      return Promise.reject(error);\n    }\n    return data;\n  });\n}\n"]},"metadata":{},"sourceType":"module"}