{"ast":null,"code":"// import config from \"config\";\nimport axios from \"axios\";\nexport function authHeader() {\n  // return authorization header with jwt token\n  let user = JSON.parse(localStorage.getItem(\"user\"));\n\n  if (user && user.token) {\n    return {\n      Authorization: \"Bearer \" + user.token\n    };\n  } else {\n    return {};\n  }\n}\nexport const userService = {\n  login,\n  logout,\n  register,\n  getAll,\n  getById,\n  update,\n  delete: _delete\n};\n\nasync function login(username, password) {\n  // let config = {\n  //   headers: {\n  //     \"Content-Type\": \"application/json\",\n  //   },\n  // };\n  // await axios\n  //   .post(\"/users/authenticate\", { username, password }, config)\n  //   .then(handleResponse)\n  //   .then((user) => {\n  //     console.log(user);\n  //     // store user details and jwt token in local storage to keep user logged in between page refreshes\n  //     localStorage.setItem(\"user\", user);\n  //     return user;\n  //   });\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  };\n  await fetch(`/users/authenticate`, requestOptions).then(handleResponse).then(user => {\n    // store user details and jwt token in local storage to keep user logged in between page refreshes\n    localStorage.setItem(\"user\", JSON.stringify(user));\n    return user;\n  });\n}\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem(\"user\");\n}\n\nfunction getAll() {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader()\n  };\n  return fetch(`/users/`, requestOptions).then(handleResponse);\n}\n\nfunction getById(id) {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader()\n  };\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction register(user) {\n  axios.post(`/users/register`, user).then(handleResponse);\n}\n\nfunction update(user) {\n  const requestOptions = {\n    method: \"PUT\",\n    headers: { ...authHeader(),\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(user)\n  };\n  return fetch(`/users/${user.id}`, requestOptions).then(handleResponse);\n} // prefixed function name with underscore because delete is a reserved word in javascript\n\n\nfunction _delete(id) {\n  const requestOptions = {\n    method: \"DELETE\",\n    headers: authHeader()\n  };\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n  console.log(response);\n  return response.text().then(text => {\n    const data = text && JSON.parse(text);\n\n    if (!response.ok) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        logout(); // location.reload(true);\n      }\n\n      const error = data && data.message || response.statusText;\n      return Promise.reject(error);\n    }\n\n    return data;\n  });\n}","map":{"version":3,"sources":["/Users/Eunice/Documents/my-app/client/src/services/UserService.js"],"names":["axios","authHeader","user","JSON","parse","localStorage","getItem","token","Authorization","userService","login","logout","register","getAll","getById","update","delete","_delete","username","password","requestOptions","method","headers","body","stringify","fetch","then","handleResponse","setItem","removeItem","id","post","response","console","log","text","data","ok","status","error","message","statusText","Promise","reject"],"mappings":"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","sourcesContent":["// import config from \"config\";\nimport axios from \"axios\";\n\nexport function authHeader() {\n  // return authorization header with jwt token\n  let user = JSON.parse(localStorage.getItem(\"user\"));\n\n  if (user && user.token) {\n    return { Authorization: \"Bearer \" + user.token };\n  } else {\n    return {};\n  }\n}\n\nexport const userService = {\n  login,\n  logout,\n  register,\n  getAll,\n  getById,\n  update,\n  delete: _delete,\n};\n\nasync function login(username, password) {\n  // let config = {\n  //   headers: {\n  //     \"Content-Type\": \"application/json\",\n  //   },\n  // };\n  // await axios\n  //   .post(\"/users/authenticate\", { username, password }, config)\n  //   .then(handleResponse)\n  //   .then((user) => {\n  //     console.log(user);\n  //     // store user details and jwt token in local storage to keep user logged in between page refreshes\n  //     localStorage.setItem(\"user\", user);\n  //     return user;\n  //   });\n\n  const requestOptions = {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ username, password }),\n  };\n\n  await fetch(`/users/authenticate`, requestOptions)\n    .then(handleResponse)\n    .then((user) => {\n      // store user details and jwt token in local storage to keep user logged in between page refreshes\n      localStorage.setItem(\"user\", JSON.stringify(user));\n\n      return user;\n    });\n}\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem(\"user\");\n}\n\nfunction getAll() {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/`, requestOptions).then(handleResponse);\n}\n\nfunction getById(id) {\n  const requestOptions = {\n    method: \"GET\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction register(user) {\n  axios.post(`/users/register`, user).then(handleResponse);\n}\n\nfunction update(user) {\n  const requestOptions = {\n    method: \"PUT\",\n    headers: { ...authHeader(), \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(user),\n  };\n\n  return fetch(`/users/${user.id}`, requestOptions).then(handleResponse);\n}\n\n// prefixed function name with underscore because delete is a reserved word in javascript\nfunction _delete(id) {\n  const requestOptions = {\n    method: \"DELETE\",\n    headers: authHeader(),\n  };\n\n  return fetch(`/users/${id}`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n  console.log(response);\n  return response.text().then((text) => {\n    const data = text && JSON.parse(text);\n    if (!response.ok) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        logout();\n        // location.reload(true);\n      }\n\n      const error = (data && data.message) || response.statusText;\n      return Promise.reject(error);\n    }\n    return data;\n  });\n}\n"]},"metadata":{},"sourceType":"module"}